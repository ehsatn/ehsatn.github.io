var a0_0x5011=a0_0x3366;(function(_0x272be4,_0x311002){var _0x35aae5=a0_0x3366,_0x332c0b=_0x272be4();while(!![]){try{var _0x48dcd7=parseInt(_0x35aae5(0x195))/0x1+-parseInt(_0x35aae5(0x16e))/0x2*(-parseInt(_0x35aae5(0x159))/0x3)+parseInt(_0x35aae5(0x18c))/0x4*(parseInt(_0x35aae5(0x17d))/0x5)+parseInt(_0x35aae5(0x16f))/0x6*(-parseInt(_0x35aae5(0x183))/0x7)+parseInt(_0x35aae5(0x16a))/0x8+parseInt(_0x35aae5(0x17f))/0x9*(parseInt(_0x35aae5(0x162))/0xa)+parseInt(_0x35aae5(0x18a))/0xb*(-parseInt(_0x35aae5(0x157))/0xc);if(_0x48dcd7===_0x311002)break;else _0x332c0b['push'](_0x332c0b['shift']());}catch(_0x4c12a1){_0x332c0b['push'](_0x332c0b['shift']());}}}(a0_0x2e42,0xb8d1f));function a0_0x3366(_0x3e4dd0,_0x402552){_0x3e4dd0=_0x3e4dd0-0x147;var _0x2e4267=a0_0x2e42();var _0x33668d=_0x2e4267[_0x3e4dd0];return _0x33668d;}var Backtest=(function(){var _0x5c9663=a0_0x3366,_0x5da84a={'trades':[],'stats':{},'equity':[]},_0x335eee={'initialCapital':0x3e8,'riskPercent':0xa,'strategy':_0x5c9663(0x155),'slMultiplier':1.5,'tp1Multiplier':0x2,'tp2Multiplier':3.5,'tp1ClosePercent':0x32};function _0x1a421b(_0x335fa8,_0x1398a4){var _0x4dea31=_0x5c9663;if(!_0x335fa8||_0x335fa8[_0x4dea31(0x196)]<0x64)return{'error':_0x4dea31(0x178)};_0x1398a4&&(_0x335eee[_0x4dea31(0x14f)]=_0x1398a4[_0x4dea31(0x14a)]||0x3e8,_0x335eee['riskPercent']=_0x1398a4[_0x4dea31(0x192)]||0xa,_0x335eee[_0x4dea31(0x189)]=_0x1398a4[_0x4dea31(0x189)]||_0x4dea31(0x155));_0x5da84a[_0x4dea31(0x173)]=[],_0x5da84a[_0x4dea31(0x148)]=[{'index':0x0,'value':_0x335eee[_0x4dea31(0x14f)]}];var _0x277228=_0x335eee[_0x4dea31(0x14f)],_0x5b1b06=null,_0x2650f9=0x0;for(var _0x513228=0x32;_0x513228<_0x335fa8[_0x4dea31(0x196)]-0x1;_0x513228++){var _0x3728c6=_0x335fa8['slice'](0x0,_0x513228+0x1),_0x3e78da=_0x335fa8[_0x513228]['c'],_0x184de8=_0x335fa8[_0x513228+0x1],_0x4d7019=_0x113f32(_0x3728c6,_0x3e78da);if(_0x5b1b06){var _0x213021=_0x10de45(_0x5b1b06,_0x184de8,_0x277228);_0x213021[_0x4dea31(0x15b)]&&(_0x5b1b06[_0x4dea31(0x17b)]=_0x213021[_0x4dea31(0x153)],_0x5b1b06[_0x4dea31(0x17a)]=_0x513228+0x1,_0x5b1b06['exitReason']=_0x213021[_0x4dea31(0x185)],_0x5b1b06[_0x4dea31(0x149)]=_0x3d1a92(_0x5b1b06),_0x5b1b06[_0x4dea31(0x16c)]=_0x5b1b06[_0x4dea31(0x149)]/_0x5b1b06[_0x4dea31(0x184)]*0x64,_0x277228+=_0x5b1b06[_0x4dea31(0x149)],_0x5da84a[_0x4dea31(0x173)][_0x4dea31(0x187)](_0x5b1b06),_0x5da84a[_0x4dea31(0x148)][_0x4dea31(0x187)]({'index':_0x513228+0x1,'value':_0x277228}),_0x5b1b06=null);}if(!_0x5b1b06&&_0x4d7019[_0x4dea31(0x186)]!==_0x4dea31(0x170)){if(!_0x31b4e1(_0x4d7019,_0x335eee[_0x4dea31(0x189)]))continue;var _0x5ae7dc=_0x184de8['o'],_0x17acb9=_0x4d7019[_0x4dea31(0x18e)],_0x338f97=_0x277228*(_0x335eee[_0x4dea31(0x192)]/0x64),_0x2d1ce2,_0x5e30b1,_0x86a378;_0x4d7019[_0x4dea31(0x186)]==='long'?(_0x2d1ce2=_0x5ae7dc-_0x17acb9*_0x335eee[_0x4dea31(0x16d)],_0x5e30b1=_0x5ae7dc+_0x17acb9*_0x335eee[_0x4dea31(0x15e)],_0x86a378=_0x5ae7dc+_0x17acb9*_0x335eee[_0x4dea31(0x164)]):(_0x2d1ce2=_0x5ae7dc+_0x17acb9*_0x335eee[_0x4dea31(0x16d)],_0x5e30b1=_0x5ae7dc-_0x17acb9*_0x335eee['tp1Multiplier'],_0x86a378=_0x5ae7dc-_0x17acb9*_0x335eee[_0x4dea31(0x164)]),_0x5b1b06={'id':++_0x2650f9,'type':_0x4d7019[_0x4dea31(0x186)],'entryPrice':_0x5ae7dc,'entryIndex':_0x513228+0x1,'size':_0x338f97,'sl':_0x2d1ce2,'tp1':_0x5e30b1,'tp2':_0x86a378,'tp1Hit':![],'confidence':_0x4d7019[_0x4dea31(0x176)],'reasons':_0x4d7019[_0x4dea31(0x175)]};}}if(_0x5b1b06){var _0x6f66e5=_0x335fa8[_0x335fa8[_0x4dea31(0x196)]-0x1]['c'];_0x5b1b06['exitPrice']=_0x6f66e5,_0x5b1b06[_0x4dea31(0x17a)]=_0x335fa8[_0x4dea31(0x196)]-0x1,_0x5b1b06[_0x4dea31(0x168)]=_0x4dea31(0x161),_0x5b1b06[_0x4dea31(0x149)]=_0x3d1a92(_0x5b1b06),_0x5b1b06[_0x4dea31(0x16c)]=_0x5b1b06[_0x4dea31(0x149)]/_0x5b1b06[_0x4dea31(0x184)]*0x64,_0x277228+=_0x5b1b06[_0x4dea31(0x149)],_0x5da84a[_0x4dea31(0x173)][_0x4dea31(0x187)](_0x5b1b06),_0x5da84a['equity']['push']({'index':_0x335fa8[_0x4dea31(0x196)]-0x1,'value':_0x277228});}return _0x5da84a[_0x4dea31(0x163)]=_0x223d5f(_0x277228),_0x5da84a;}function _0x113f32(_0x4d6884,_0x11093f){var _0xfe0174=_0x5c9663,_0x11216e={'signal':_0xfe0174(0x170),'confidence':0x0,'atr':0x0,'reasons':[]};if(!_0x4d6884||_0x4d6884['length']<0x32)return _0x11216e;var _0x3027b3=_0x4d6884[_0xfe0174(0x14e)](function(_0x4200d6){return _0x4200d6['c'];}),_0x45be7b=TradingCore[_0xfe0174(0x190)](_0x3027b3,0xe),_0x5b65ae=TradingCore[_0xfe0174(0x198)](_0x3027b3,0x15),_0x3495ef=TradingCore[_0xfe0174(0x198)](_0x3027b3,0x32),_0x337b6e=TradingCore[_0xfe0174(0x147)](_0x3027b3),_0x187840=TradingCore['calcBB'](_0x3027b3,0x14,0x2),_0x3bfa7e=TradingCore[_0xfe0174(0x15d)](_0x4d6884,0xe),_0x170dc9=TradingCore[_0xfe0174(0x193)](_0x4d6884,0xe,_0x11093f);_0x11216e[_0xfe0174(0x18e)]=_0x170dc9,_0x11216e[_0xfe0174(0x167)]=_0x3bfa7e;var _0x441de1=0x0,_0x3f4e54=0x0;if(_0x45be7b<=0x1e)_0x441de1+=0x3,_0x11216e[_0xfe0174(0x175)][_0xfe0174(0x187)]('RSI\x20Oversold');else{if(_0x45be7b<=0x28)_0x441de1+=0x1;else{if(_0x45be7b>=0x46)_0x3f4e54+=0x3,_0x11216e[_0xfe0174(0x175)]['push'](_0xfe0174(0x15f));else _0x45be7b>=0x3c&&(_0x3f4e54+=0x1);}}var _0x12376e=_0xfe0174(0x170);if(_0x11093f>_0x5b65ae&&_0x5b65ae>_0x3495ef)_0x12376e='up',_0x441de1+=0x2,_0x11216e[_0xfe0174(0x175)]['push'](_0xfe0174(0x160));else _0x11093f<_0x5b65ae&&_0x5b65ae<_0x3495ef&&(_0x12376e=_0xfe0174(0x181),_0x3f4e54+=0x2,_0x11216e[_0xfe0174(0x175)]['push'](_0xfe0174(0x165)));_0x11216e[_0xfe0174(0x179)]=_0x12376e;if(_0x337b6e[_0xfe0174(0x174)]>0x0)_0x441de1+=0x2;else _0x337b6e[_0xfe0174(0x174)]<0x0&&(_0x3f4e54+=0x2);var _0x13e605=(_0x11093f-_0x187840['lower'])/(_0x187840[_0xfe0174(0x191)]-_0x187840[_0xfe0174(0x172)]);if(_0x13e605<=0.15)_0x441de1+=0x2,_0x11216e[_0xfe0174(0x175)]['push'](_0xfe0174(0x16b));else _0x13e605>=0.85&&(_0x3f4e54+=0x2,_0x11216e[_0xfe0174(0x175)][_0xfe0174(0x187)](_0xfe0174(0x154)));if(_0x3bfa7e[_0xfe0174(0x167)]>=0x19){if(_0x3bfa7e[_0xfe0174(0x179)]===_0xfe0174(0x14d))_0x441de1+=0x2;else _0x3bfa7e[_0xfe0174(0x179)]===_0xfe0174(0x17c)&&(_0x3f4e54+=0x2);}var _0x438776=0x5,_0x63d19e=0x3;if(_0x441de1>=_0x438776&&_0x441de1>_0x3f4e54+_0x63d19e)_0x11216e[_0xfe0174(0x186)]=_0xfe0174(0x18f),_0x11216e[_0xfe0174(0x176)]=Math[_0xfe0174(0x14c)](0xa,Math[_0xfe0174(0x151)](_0x441de1/1.5));else _0x3f4e54>=_0x438776&&_0x3f4e54>_0x441de1+_0x63d19e&&(_0x11216e[_0xfe0174(0x186)]=_0xfe0174(0x18b),_0x11216e[_0xfe0174(0x176)]=Math[_0xfe0174(0x14c)](0xa,Math['round'](_0x3f4e54/1.5)));return _0x11216e;}function _0x31b4e1(_0x129cf4,_0x302465){var _0xf9019c=_0x5c9663;if(_0x302465===_0xf9019c(0x177))return _0x129cf4[_0xf9019c(0x176)]>=0x7;if(_0x302465===_0xf9019c(0x169)){if(!_0x129cf4[_0xf9019c(0x167)]||_0x129cf4['adx'][_0xf9019c(0x167)]<0x19)return![];if(_0x129cf4[_0xf9019c(0x186)]===_0xf9019c(0x18f)&&_0x129cf4[_0xf9019c(0x179)]!=='up')return![];if(_0x129cf4[_0xf9019c(0x186)]===_0xf9019c(0x18b)&&_0x129cf4[_0xf9019c(0x179)]!==_0xf9019c(0x181))return![];}return!![];}function _0x10de45(_0x188c04,_0x2172a6,_0x4f8901){var _0x5b1312=_0x5c9663,_0x23df23={'exit':![],'price':0x0,'reason':''};if(_0x188c04['type']===_0x5b1312(0x18f)){if(_0x2172a6['l']<=_0x188c04['sl'])return _0x23df23[_0x5b1312(0x15b)]=!![],_0x23df23[_0x5b1312(0x153)]=_0x188c04['sl'],_0x23df23[_0x5b1312(0x185)]=_0x5b1312(0x150),_0x23df23;!_0x188c04[_0x5b1312(0x182)]&&_0x2172a6['h']>=_0x188c04[_0x5b1312(0x158)]&&(_0x188c04[_0x5b1312(0x182)]=!![],_0x188c04['sl']=_0x188c04[_0x5b1312(0x15a)]);if(_0x2172a6['h']>=_0x188c04[_0x5b1312(0x197)])return _0x23df23['exit']=!![],_0x23df23['price']=_0x188c04[_0x5b1312(0x197)],_0x23df23['reason']=_0x5b1312(0x14b),_0x23df23;}else{if(_0x2172a6['h']>=_0x188c04['sl'])return _0x23df23[_0x5b1312(0x15b)]=!![],_0x23df23['price']=_0x188c04['sl'],_0x23df23[_0x5b1312(0x185)]='استاپ‌لاس',_0x23df23;!_0x188c04[_0x5b1312(0x182)]&&_0x2172a6['l']<=_0x188c04['tp1']&&(_0x188c04[_0x5b1312(0x182)]=!![],_0x188c04['sl']=_0x188c04[_0x5b1312(0x15a)]);if(_0x2172a6['l']<=_0x188c04[_0x5b1312(0x197)])return _0x23df23[_0x5b1312(0x15b)]=!![],_0x23df23[_0x5b1312(0x153)]=_0x188c04[_0x5b1312(0x197)],_0x23df23['reason']=_0x5b1312(0x14b),_0x23df23;}return _0x23df23;}function _0x3d1a92(_0x5b1982){var _0x308d8f=_0x5c9663,_0x443d11=_0x5b1982['exitPrice']-_0x5b1982[_0x308d8f(0x15a)];if(_0x5b1982['type']===_0x308d8f(0x18b))_0x443d11=-_0x443d11;return _0x443d11/_0x5b1982[_0x308d8f(0x15a)]*_0x5b1982[_0x308d8f(0x184)];}function _0x223d5f(_0x25f217){var _0x2d9bdf=_0x5c9663,_0x2ece51=_0x5da84a[_0x2d9bdf(0x173)];if(_0x2ece51[_0x2d9bdf(0x196)]===0x0)return{'totalTrades':0x0,'winRate':0x0,'profitFactor':0x0,'totalReturn':0x0,'maxDrawdown':0x0,'avgWin':0x0,'avgLoss':0x0,'bestTrade':0x0,'worstTrade':0x0,'avgHoldingPeriod':0x0};var _0x3c57eb=_0x2ece51['filter'](function(_0x5b5de4){var _0xc00522=_0x2d9bdf;return _0x5b5de4[_0xc00522(0x149)]>0x0;}),_0x5c2237=_0x2ece51['filter'](function(_0x5dcba1){return _0x5dcba1['pnl']<=0x0;}),_0x4ab4af=_0x3c57eb[_0x2d9bdf(0x18d)](function(_0x36c654,_0x24e4c5){return _0x36c654+_0x24e4c5['pnl'];},0x0),_0x44b9d3=Math['abs'](_0x5c2237[_0x2d9bdf(0x18d)](function(_0x27df73,_0x41af1f){return _0x27df73+_0x41af1f['pnl'];},0x0)),_0x3c6a8a=_0x335eee[_0x2d9bdf(0x14f)],_0x403b6a=0x0;_0x5da84a[_0x2d9bdf(0x148)]['forEach'](function(_0x5bbd8e){var _0x278117=_0x2d9bdf;if(_0x5bbd8e['value']>_0x3c6a8a)_0x3c6a8a=_0x5bbd8e['value'];var _0x495a1d=(_0x3c6a8a-_0x5bbd8e[_0x278117(0x188)])/_0x3c6a8a*0x64;if(_0x495a1d>_0x403b6a)_0x403b6a=_0x495a1d;});var _0x377026=_0x2ece51[_0x2d9bdf(0x18d)](function(_0x1bb4bd,_0x544b37){var _0xaf352b=_0x2d9bdf;return _0x1bb4bd+(_0x544b37['exitIndex']-_0x544b37[_0xaf352b(0x166)]);},0x0),_0x5dde92=_0x2ece51[_0x2d9bdf(0x14e)](function(_0xdafc43){var _0x1bba25=_0x2d9bdf;return _0xdafc43[_0x1bba25(0x149)];});return{'totalTrades':_0x2ece51[_0x2d9bdf(0x196)],'winningTrades':_0x3c57eb[_0x2d9bdf(0x196)],'losingTrades':_0x5c2237[_0x2d9bdf(0x196)],'winRate':(_0x3c57eb[_0x2d9bdf(0x196)]/_0x2ece51[_0x2d9bdf(0x196)]*0x64)[_0x2d9bdf(0x194)](0x1),'profitFactor':_0x44b9d3>0x0?(_0x4ab4af/_0x44b9d3)['toFixed'](0x2):_0x2d9bdf(0x156),'totalReturn':((_0x25f217-_0x335eee[_0x2d9bdf(0x14f)])/_0x335eee[_0x2d9bdf(0x14f)]*0x64)[_0x2d9bdf(0x194)](0x2),'finalCapital':_0x25f217[_0x2d9bdf(0x194)](0x2),'maxDrawdown':_0x403b6a[_0x2d9bdf(0x194)](0x2),'avgWin':_0x3c57eb[_0x2d9bdf(0x196)]>0x0?(_0x4ab4af/_0x3c57eb[_0x2d9bdf(0x196)])[_0x2d9bdf(0x194)](0x2):0x0,'avgLoss':_0x5c2237[_0x2d9bdf(0x196)]>0x0?(_0x44b9d3/_0x5c2237['length'])[_0x2d9bdf(0x194)](0x2):0x0,'bestTrade':Math[_0x2d9bdf(0x180)][_0x2d9bdf(0x17e)](null,_0x5dde92)[_0x2d9bdf(0x194)](0x2),'worstTrade':Math[_0x2d9bdf(0x14c)][_0x2d9bdf(0x17e)](null,_0x5dde92)['toFixed'](0x2),'avgHoldingPeriod':Math[_0x2d9bdf(0x151)](_0x377026/_0x2ece51['length']),'longTrades':_0x2ece51[_0x2d9bdf(0x171)](function(_0x225809){var _0x4056f8=_0x2d9bdf;return _0x225809[_0x4056f8(0x15c)]==='long';})['length'],'shortTrades':_0x2ece51[_0x2d9bdf(0x171)](function(_0x4447b1){var _0x1f5c5c=_0x2d9bdf;return _0x4447b1[_0x1f5c5c(0x15c)]===_0x1f5c5c(0x18b);})['length']};}function _0xf7be76(){var _0x524303=_0x5c9663;return _0x5da84a[_0x524303(0x148)];}function _0x51b9ab(){var _0x2e88aa=_0x5c9663;return _0x5da84a[_0x2e88aa(0x173)];}function _0x504b85(){var _0x58978d=_0x5c9663;return _0x5da84a[_0x58978d(0x163)];}return{'run':_0x1a421b,'getEquityData':_0xf7be76,'getTrades':_0x51b9ab,'getStats':_0x504b85};}());typeof window!==a0_0x5011(0x152)&&(window['Backtest']=Backtest);function a0_0x2e42(){var _0x43d0cb=['slMultiplier','68980ONGofk','6MVSYRW','neutral','filter','lower','trades','histogram','reasons','confidence','conservative','داده\x20کافی\x20نیست\x20(حداقل\x20100\x20کندل)','trend','exitIndex','exitPrice','strong_down','20975viIniz','apply','1572597EPQqgK','max','down','tp1Hit','5670217VKBWvB','size','reason','signal','push','value','strategy','11198SvLzdS','short','1356hMsTgc','reduce','atr','long','calcRSI','upper','riskPercent','calcATR','toFixed','920115ChhJjf','length','tp2','calcEMA','calcMACD','equity','pnl','capital','تارگت\x20۲','min','strong_up','map','initialCapital','استاپ‌لاس','round','undefined','price','سقف\x20BB','default','N/A','26124IlZtMe','tp1','75JOksUC','entryPrice','exit','type','calcADX','tp1Multiplier','RSI\x20Overbought','روند\x20صعودی','پایان\x20بک‌تست','10oamMDq','stats','tp2Multiplier','روند\x20نزولی','entryIndex','adx','exitReason','trend_following','3232296FeYVkV','کف\x20BB','pnlPercent'];a0_0x2e42=function(){return _0x43d0cb;};return a0_0x2e42();}