var a0_0x15ecdb=a0_0x2a80;(function(_0x3ada50,_0x1d49a8){var _0x4356c0=a0_0x2a80,_0x14f19b=_0x3ada50();while(!![]){try{var _0x316d1e=parseInt(_0x4356c0(0x236))/0x1+parseInt(_0x4356c0(0x215))/0x2+parseInt(_0x4356c0(0x225))/0x3*(parseInt(_0x4356c0(0x213))/0x4)+-parseInt(_0x4356c0(0x1f0))/0x5*(parseInt(_0x4356c0(0x222))/0x6)+-parseInt(_0x4356c0(0x229))/0x7*(parseInt(_0x4356c0(0x201))/0x8)+parseInt(_0x4356c0(0x20a))/0x9*(-parseInt(_0x4356c0(0x234))/0xa)+parseInt(_0x4356c0(0x22d))/0xb;if(_0x316d1e===_0x1d49a8)break;else _0x14f19b['push'](_0x14f19b['shift']());}catch(_0x5568e6){_0x14f19b['push'](_0x14f19b['shift']());}}}(a0_0x4a30,0x1c6c2));function a0_0x2a80(_0x237dfc,_0x4f2a9a){_0x237dfc=_0x237dfc-0x1ef;var _0x4a3013=a0_0x4a30();var _0x2a8006=_0x4a3013[_0x237dfc];return _0x2a8006;}var Backtest=(function(){var _0x16f375=a0_0x2a80,_0x167ca8={'trades':[],'stats':{},'equity':[]},_0x390819={'initialCapital':0x3e8,'riskPercent':0xa,'strategy':_0x16f375(0x23f),'slMultiplier':1.5,'tp1Multiplier':0x2,'tp2Multiplier':3.5,'tp1ClosePercent':0x32};function _0x43be05(_0x48b599,_0x55ecef){var _0x3f6791=_0x16f375;if(!_0x48b599||_0x48b599[_0x3f6791(0x20e)]<0x64)return{'error':_0x3f6791(0x228)};_0x55ecef&&(_0x390819['initialCapital']=_0x55ecef[_0x3f6791(0x1fd)]||0x3e8,_0x390819[_0x3f6791(0x206)]=_0x55ecef[_0x3f6791(0x206)]||0xa,_0x390819['strategy']=_0x55ecef[_0x3f6791(0x21a)]||_0x3f6791(0x23f));_0x167ca8[_0x3f6791(0x1fc)]=[],_0x167ca8[_0x3f6791(0x210)]=[{'index':0x0,'value':_0x390819[_0x3f6791(0x226)]}];var _0x490dfc=_0x390819['initialCapital'],_0x1565ca=null,_0x1a81d5=0x0;for(var _0x388b2e=0x32;_0x388b2e<_0x48b599['length']-0x1;_0x388b2e++){var _0x4735cc=_0x48b599[_0x3f6791(0x212)](0x0,_0x388b2e+0x1),_0x257195=_0x48b599[_0x388b2e]['c'],_0xb97fb1=_0x48b599[_0x388b2e+0x1],_0x4b27e7=_0x2fa8fa(_0x4735cc,_0x257195);if(_0x1565ca){var _0x1ef1d1=_0x4dffc6(_0x1565ca,_0xb97fb1,_0x490dfc);_0x1ef1d1[_0x3f6791(0x21e)]&&(_0x1565ca[_0x3f6791(0x1f3)]=_0x1ef1d1['price'],_0x1565ca[_0x3f6791(0x23a)]=_0x388b2e+0x1,_0x1565ca[_0x3f6791(0x219)]=_0x1ef1d1[_0x3f6791(0x1f5)],_0x1565ca[_0x3f6791(0x1ef)]=_0x364ec2(_0x1565ca),_0x1565ca[_0x3f6791(0x1fe)]=_0x1565ca[_0x3f6791(0x1ef)]/_0x1565ca[_0x3f6791(0x208)]*0x64,_0x490dfc+=_0x1565ca['pnl'],_0x167ca8['trades'][_0x3f6791(0x200)](_0x1565ca),_0x167ca8['equity'][_0x3f6791(0x200)]({'index':_0x388b2e+0x1,'value':_0x490dfc}),_0x1565ca=null);}if(!_0x1565ca&&_0x4b27e7[_0x3f6791(0x230)]!==_0x3f6791(0x239)){if(!_0x13ede8(_0x4b27e7,_0x390819['strategy']))continue;var _0x24586a=_0xb97fb1['o'],_0x47e472=_0x4b27e7[_0x3f6791(0x203)],_0xaf93fe=_0x490dfc*(_0x390819[_0x3f6791(0x206)]/0x64),_0x5e5f6c,_0x30294b,_0x149a8d;_0x4b27e7['signal']===_0x3f6791(0x22e)?(_0x5e5f6c=_0x24586a-_0x47e472*_0x390819['slMultiplier'],_0x30294b=_0x24586a+_0x47e472*_0x390819[_0x3f6791(0x209)],_0x149a8d=_0x24586a+_0x47e472*_0x390819['tp2Multiplier']):(_0x5e5f6c=_0x24586a+_0x47e472*_0x390819['slMultiplier'],_0x30294b=_0x24586a-_0x47e472*_0x390819[_0x3f6791(0x209)],_0x149a8d=_0x24586a-_0x47e472*_0x390819[_0x3f6791(0x1fb)]),_0x1565ca={'id':++_0x1a81d5,'type':_0x4b27e7[_0x3f6791(0x230)],'entryPrice':_0x24586a,'entryIndex':_0x388b2e+0x1,'size':_0xaf93fe,'sl':_0x5e5f6c,'tp1':_0x30294b,'tp2':_0x149a8d,'tp1Hit':![],'confidence':_0x4b27e7[_0x3f6791(0x211)],'reasons':_0x4b27e7[_0x3f6791(0x217)]};}}if(_0x1565ca){var _0x121015=_0x48b599[_0x48b599[_0x3f6791(0x20e)]-0x1]['c'];_0x1565ca[_0x3f6791(0x1f3)]=_0x121015,_0x1565ca[_0x3f6791(0x23a)]=_0x48b599[_0x3f6791(0x20e)]-0x1,_0x1565ca['exitReason']=_0x3f6791(0x23e),_0x1565ca['pnl']=_0x364ec2(_0x1565ca),_0x1565ca['pnlPercent']=_0x1565ca[_0x3f6791(0x1ef)]/_0x1565ca[_0x3f6791(0x208)]*0x64,_0x490dfc+=_0x1565ca[_0x3f6791(0x1ef)],_0x167ca8[_0x3f6791(0x1fc)][_0x3f6791(0x200)](_0x1565ca),_0x167ca8[_0x3f6791(0x210)][_0x3f6791(0x200)]({'index':_0x48b599['length']-0x1,'value':_0x490dfc});}return _0x167ca8[_0x3f6791(0x204)]=_0x1147ac(_0x490dfc),_0x167ca8;}function _0x2fa8fa(_0x25fc20,_0x7da167){var _0x3bbe8f=_0x16f375,_0x2b3d8f={'signal':'neutral','confidence':0x0,'atr':0x0,'reasons':[]};if(!_0x25fc20||_0x25fc20[_0x3bbe8f(0x20e)]<0x32)return _0x2b3d8f;var _0x5df806=_0x25fc20[_0x3bbe8f(0x223)](function(_0x48f6b8){return _0x48f6b8['c'];}),_0x187e35=TradingCore['calcRSI'](_0x5df806,0xe),_0x240dff=TradingCore[_0x3bbe8f(0x241)](_0x5df806,0x15),_0x180c53=TradingCore[_0x3bbe8f(0x241)](_0x5df806,0x32),_0x4d847d=TradingCore[_0x3bbe8f(0x207)](_0x5df806),_0x28f189=TradingCore['calcBB'](_0x5df806,0x14,0x2),_0x1261c2=TradingCore[_0x3bbe8f(0x214)](_0x25fc20,0xe),_0x440ef2=TradingCore[_0x3bbe8f(0x1f6)](_0x25fc20,0xe,_0x7da167);_0x2b3d8f[_0x3bbe8f(0x203)]=_0x440ef2,_0x2b3d8f[_0x3bbe8f(0x23b)]=_0x1261c2;var _0x124899=0x0,_0xe989c8=0x0;if(_0x187e35<=0x1e)_0x124899+=0x3,_0x2b3d8f[_0x3bbe8f(0x217)][_0x3bbe8f(0x200)](_0x3bbe8f(0x240));else{if(_0x187e35<=0x28)_0x124899+=0x1;else{if(_0x187e35>=0x46)_0xe989c8+=0x3,_0x2b3d8f[_0x3bbe8f(0x217)]['push'](_0x3bbe8f(0x227));else _0x187e35>=0x3c&&(_0xe989c8+=0x1);}}var _0x4fdd74=_0x3bbe8f(0x239);if(_0x7da167>_0x240dff&&_0x240dff>_0x180c53)_0x4fdd74='up',_0x124899+=0x2,_0x2b3d8f[_0x3bbe8f(0x217)][_0x3bbe8f(0x200)](_0x3bbe8f(0x22a));else _0x7da167<_0x240dff&&_0x240dff<_0x180c53&&(_0x4fdd74=_0x3bbe8f(0x1f8),_0xe989c8+=0x2,_0x2b3d8f[_0x3bbe8f(0x217)]['push'](_0x3bbe8f(0x20f)));_0x2b3d8f[_0x3bbe8f(0x235)]=_0x4fdd74;if(_0x4d847d[_0x3bbe8f(0x23c)]>0x0)_0x124899+=0x2;else _0x4d847d[_0x3bbe8f(0x23c)]<0x0&&(_0xe989c8+=0x2);var _0x388f21=(_0x7da167-_0x28f189[_0x3bbe8f(0x1f9)])/(_0x28f189[_0x3bbe8f(0x232)]-_0x28f189['lower']);if(_0x388f21<=0.15)_0x124899+=0x2,_0x2b3d8f[_0x3bbe8f(0x217)][_0x3bbe8f(0x200)](_0x3bbe8f(0x21d));else _0x388f21>=0.85&&(_0xe989c8+=0x2,_0x2b3d8f['reasons'][_0x3bbe8f(0x200)](_0x3bbe8f(0x1fa)));if(_0x1261c2['adx']>=0x19){if(_0x1261c2['trend']==='strong_up')_0x124899+=0x2;else _0x1261c2[_0x3bbe8f(0x235)]===_0x3bbe8f(0x224)&&(_0xe989c8+=0x2);}var _0x23e9b9=0x5,_0x207902=0x3;if(_0x124899>=_0x23e9b9&&_0x124899>_0xe989c8+_0x207902)_0x2b3d8f[_0x3bbe8f(0x230)]='long',_0x2b3d8f[_0x3bbe8f(0x211)]=Math[_0x3bbe8f(0x22f)](0xa,Math['round'](_0x124899/1.5));else _0xe989c8>=_0x23e9b9&&_0xe989c8>_0x124899+_0x207902&&(_0x2b3d8f[_0x3bbe8f(0x230)]=_0x3bbe8f(0x23d),_0x2b3d8f[_0x3bbe8f(0x211)]=Math['min'](0xa,Math[_0x3bbe8f(0x1f1)](_0xe989c8/1.5)));return _0x2b3d8f;}function _0x13ede8(_0x4461c5,_0x4d2dde){var _0x37f9a6=_0x16f375;if(_0x4d2dde===_0x37f9a6(0x218))return _0x4461c5['confidence']>=0x7;if(_0x4d2dde===_0x37f9a6(0x1ff)){if(!_0x4461c5[_0x37f9a6(0x23b)]||_0x4461c5[_0x37f9a6(0x23b)][_0x37f9a6(0x23b)]<0x19)return![];if(_0x4461c5[_0x37f9a6(0x230)]===_0x37f9a6(0x22e)&&_0x4461c5['trend']!=='up')return![];if(_0x4461c5['signal']===_0x37f9a6(0x23d)&&_0x4461c5[_0x37f9a6(0x235)]!==_0x37f9a6(0x1f8))return![];}return!![];}function _0x4dffc6(_0x4522a4,_0xcf5e30,_0x1ea780){var _0x2c0123=_0x16f375,_0x1517cb={'exit':![],'price':0x0,'reason':''};if(_0x4522a4['type']===_0x2c0123(0x22e)){if(_0xcf5e30['l']<=_0x4522a4['sl'])return _0x1517cb[_0x2c0123(0x21e)]=!![],_0x1517cb[_0x2c0123(0x237)]=_0x4522a4['sl'],_0x1517cb[_0x2c0123(0x1f5)]=_0x2c0123(0x202),_0x1517cb;!_0x4522a4[_0x2c0123(0x238)]&&_0xcf5e30['h']>=_0x4522a4['tp1']&&(_0x4522a4[_0x2c0123(0x238)]=!![],_0x4522a4['sl']=_0x4522a4[_0x2c0123(0x221)]);if(_0xcf5e30['h']>=_0x4522a4['tp2'])return _0x1517cb[_0x2c0123(0x21e)]=!![],_0x1517cb[_0x2c0123(0x237)]=_0x4522a4[_0x2c0123(0x1f4)],_0x1517cb['reason']=_0x2c0123(0x231),_0x1517cb;}else{if(_0xcf5e30['h']>=_0x4522a4['sl'])return _0x1517cb[_0x2c0123(0x21e)]=!![],_0x1517cb[_0x2c0123(0x237)]=_0x4522a4['sl'],_0x1517cb[_0x2c0123(0x1f5)]='استاپ‌لاس',_0x1517cb;!_0x4522a4[_0x2c0123(0x238)]&&_0xcf5e30['l']<=_0x4522a4[_0x2c0123(0x21f)]&&(_0x4522a4[_0x2c0123(0x238)]=!![],_0x4522a4['sl']=_0x4522a4[_0x2c0123(0x221)]);if(_0xcf5e30['l']<=_0x4522a4[_0x2c0123(0x1f4)])return _0x1517cb['exit']=!![],_0x1517cb[_0x2c0123(0x237)]=_0x4522a4[_0x2c0123(0x1f4)],_0x1517cb[_0x2c0123(0x1f5)]=_0x2c0123(0x231),_0x1517cb;}return _0x1517cb;}function _0x364ec2(_0x3caf21){var _0x5786a3=_0x16f375,_0x5af9f9=_0x3caf21['exitPrice']-_0x3caf21[_0x5786a3(0x221)];if(_0x3caf21[_0x5786a3(0x220)]===_0x5786a3(0x23d))_0x5af9f9=-_0x5af9f9;return _0x5af9f9/_0x3caf21[_0x5786a3(0x221)]*_0x3caf21['size'];}function _0x1147ac(_0x68fd7){var _0x1f1532=_0x16f375,_0x24f8a5=_0x167ca8[_0x1f1532(0x1fc)];if(_0x24f8a5[_0x1f1532(0x20e)]===0x0)return{'totalTrades':0x0,'winRate':0x0,'profitFactor':0x0,'totalReturn':0x0,'maxDrawdown':0x0,'avgWin':0x0,'avgLoss':0x0,'bestTrade':0x0,'worstTrade':0x0,'avgHoldingPeriod':0x0};var _0x3ac320=_0x24f8a5[_0x1f1532(0x20d)](function(_0x3eb2b9){var _0x407db4=_0x1f1532;return _0x3eb2b9[_0x407db4(0x1ef)]>0x0;}),_0x14bda=_0x24f8a5['filter'](function(_0x5614da){var _0xe1fbcb=_0x1f1532;return _0x5614da[_0xe1fbcb(0x1ef)]<=0x0;}),_0x476c4=_0x3ac320[_0x1f1532(0x1f2)](function(_0x5cd759,_0x5267c5){return _0x5cd759+_0x5267c5['pnl'];},0x0),_0x5d7379=Math[_0x1f1532(0x20c)](_0x14bda[_0x1f1532(0x1f2)](function(_0x1809de,_0x2b2492){return _0x1809de+_0x2b2492['pnl'];},0x0)),_0x306d9c=_0x390819[_0x1f1532(0x226)],_0x5f562f=0x0;_0x167ca8[_0x1f1532(0x210)][_0x1f1532(0x21c)](function(_0x1079eb){var _0x98bf0b=_0x1f1532;if(_0x1079eb['value']>_0x306d9c)_0x306d9c=_0x1079eb[_0x98bf0b(0x22b)];var _0x10be6c=(_0x306d9c-_0x1079eb['value'])/_0x306d9c*0x64;if(_0x10be6c>_0x5f562f)_0x5f562f=_0x10be6c;});var _0x31f37d=_0x24f8a5[_0x1f1532(0x1f2)](function(_0x3edf76,_0x21646d){var _0x138711=_0x1f1532;return _0x3edf76+(_0x21646d[_0x138711(0x23a)]-_0x21646d[_0x138711(0x21b)]);},0x0),_0x9c4c1a=_0x24f8a5[_0x1f1532(0x223)](function(_0x2b2c1b){var _0x3b1568=_0x1f1532;return _0x2b2c1b[_0x3b1568(0x1ef)];});return{'totalTrades':_0x24f8a5[_0x1f1532(0x20e)],'winningTrades':_0x3ac320[_0x1f1532(0x20e)],'losingTrades':_0x14bda[_0x1f1532(0x20e)],'winRate':(_0x3ac320[_0x1f1532(0x20e)]/_0x24f8a5['length']*0x64)[_0x1f1532(0x205)](0x1),'profitFactor':_0x5d7379>0x0?(_0x476c4/_0x5d7379)[_0x1f1532(0x205)](0x2):_0x1f1532(0x233),'totalReturn':((_0x68fd7-_0x390819['initialCapital'])/_0x390819['initialCapital']*0x64)[_0x1f1532(0x205)](0x2),'finalCapital':_0x68fd7[_0x1f1532(0x205)](0x2),'maxDrawdown':_0x5f562f[_0x1f1532(0x205)](0x2),'avgWin':_0x3ac320[_0x1f1532(0x20e)]>0x0?(_0x476c4/_0x3ac320[_0x1f1532(0x20e)])['toFixed'](0x2):0x0,'avgLoss':_0x14bda[_0x1f1532(0x20e)]>0x0?(_0x5d7379/_0x14bda[_0x1f1532(0x20e)])['toFixed'](0x2):0x0,'bestTrade':Math[_0x1f1532(0x20b)][_0x1f1532(0x216)](null,_0x9c4c1a)[_0x1f1532(0x205)](0x2),'worstTrade':Math[_0x1f1532(0x22f)]['apply'](null,_0x9c4c1a)[_0x1f1532(0x205)](0x2),'avgHoldingPeriod':Math[_0x1f1532(0x1f1)](_0x31f37d/_0x24f8a5[_0x1f1532(0x20e)]),'longTrades':_0x24f8a5[_0x1f1532(0x20d)](function(_0x1b563f){var _0x28c8c6=_0x1f1532;return _0x1b563f[_0x28c8c6(0x220)]===_0x28c8c6(0x22e);})[_0x1f1532(0x20e)],'shortTrades':_0x24f8a5[_0x1f1532(0x20d)](function(_0xaec2b8){var _0x5c558f=_0x1f1532;return _0xaec2b8[_0x5c558f(0x220)]===_0x5c558f(0x23d);})[_0x1f1532(0x20e)]};}function _0x2ee385(){var _0x2f808a=_0x16f375;return _0x167ca8[_0x2f808a(0x210)];}function _0x14b644(){return _0x167ca8['trades'];}function _0x35e8e2(){var _0x491fe4=_0x16f375;return _0x167ca8[_0x491fe4(0x204)];}return{'run':_0x43be05,'getEquityData':_0x2ee385,'getTrades':_0x14b644,'getStats':_0x35e8e2};}());typeof window!==a0_0x15ecdb(0x1f7)&&(window[a0_0x15ecdb(0x22c)]=Backtest);function a0_0x4a30(){var _0x6b753b=['down','lower','سقف\x20BB','tp2Multiplier','trades','capital','pnlPercent','trend_following','push','125224rmTYby','استاپ‌لاس','atr','stats','toFixed','riskPercent','calcMACD','size','tp1Multiplier','18pZKrxW','max','abs','filter','length','روند\x20نزولی','equity','confidence','slice','548XLMEBk','calcADX','27462GawXwU','apply','reasons','conservative','exitReason','strategy','entryIndex','forEach','کف\x20BB','exit','tp1','type','entryPrice','72XIvGTG','map','strong_down','738pLenbK','initialCapital','RSI\x20Overbought','داده\x20کافی\x20نیست\x20(حداقل\x20100\x20کندل)','49yPAPcl','روند\x20صعودی','value','Backtest','2777632Gbkqhh','long','min','signal','تارگت\x20۲','upper','N/A','1002430lyCRJy','trend','174854RqJFPZ','price','tp1Hit','neutral','exitIndex','adx','histogram','short','پایان\x20بک‌تست','default','RSI\x20Oversold','calcEMA','pnl','20135vSoxJd','round','reduce','exitPrice','tp2','reason','calcATR','undefined'];a0_0x4a30=function(){return _0x6b753b;};return a0_0x4a30();}