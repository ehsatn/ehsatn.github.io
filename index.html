<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"3e6ad4ceb5ef07252476b6bf0a30aeff5f6085374da74de1c9a5645ea36c6c82e345840893572b8f070da992337dffbdf8382a24850588454479fdcd69caf778905e7657d33228203add8e558e60a026a8ad851494a056d07cbac3d905661a2333459d5f92fd9fbf7114d77147490ee9a632d80aa29ccf140bf2ca51a24b85b2b4fa9ba0edcc28344dd1a7a7e0d77b0a8cefb3a9950a446b4af00804ffd8e3632875af3e0c08e70c4c76128d4005c774191c488f26012a75aeaab7aa3aa39b133781b137aa8dc5d96af5fb28048b62156cf36f83d0e78b4bed252426df35b88a46603a55c6e93b1e011830d28d73e37740c69f12089d88889097ddabf4db9f91a6fee3a19cae26860dcb019b289796f329aa2bee2a247d7e3fe2e8ca0aa736f6b9536b93310cdf7ac005fa719b2cb9c9a61b050bde88dcf67f82d0661b1f7636abe5cf9850885da9fce66bf9b1907a222c764a912f79573116f5386a2e66339355b2a4ea2b50e4570d6f6421345c9e906b0c5cc6b14f07bbf7a92fc12d47b8d9f89c792bf3fd3ddad8be78f1fc33d1e17f9449f325fd3ae19528d5b37c0680775348367c7be8dd9f88de5243322961e699c91b4066caa6c552fdd8787f06031f3a875d155941e6dd43a1475f7b03e0bfda9111474fb08555049b6021bd60cbab2fa0407efdc7ace3317a6e8866da44f54f0d14ebc3ef637ec564fadbb3d5cb602f576d1f47d280478bbdb423d800e2ff58f0b257ff59667b5423322e494947a7ef0567f065bbb3ed4f24f83ffa0699514cf561a7ed8bd9f30d747b8f3b0c8c1982df179c402afcd3404ec4a058b529c0adb46caa741e23b9eec7c952e74589f12e59d50de6e0d5a5894e01010e7d37ffbb94043dd3bfb4f0312c4f1a0d3feceb4361f62fb06f45e8c4895ad7de7034fe885520d6d02ae87443f6627e0fd1961fba168638fb2e1b9a4c6c67492bcdff17964fb63bd36a4733b6799c751bf31633998108197669f5c491df4c73f0b89dbf252dda384940eadde836af5de286f51d771d0102c3b5635269739b840032ade875eaa3e29789769477fb01c810371daebff001adf11a0d88ca94ef039c7b59b3b48f32b4b40a3adc0c2c637871e14f4c4f5d2e017284623da3286159c941767da199ff34726633feacc8d71dc97345fd3b153f6b5fef0df4e94629c972f42998ddc82d16aabae91df84004d1a3f52e9392b772eff206fc65fabf9bf67564745ccee6c61fb6a010f722639cc0437048680214cdbd37ed4ace361add0a876b7aed1e46b8ee89519fa214a99eba9f1b87681c7fe0712079a00a9b0cdec1aded7e9ca3d0432b8dbd1cdcae8856cc37a2ba9886dde66380b12168007149ee4702fcb3dd1e0e1c002bf270088d4d6246e66cdeb828e8fc27ab1d573d26894fb210d10d8a4b61cb6cfd8f0bd9b3a1150b1505491d08f4e45f531f68dbfe92fa23bcdafe2ef1600441af1cd2bffaa85d6548c6b464125236b8f79ac6215d7b9e17c1fe506ef10c53a68b65c6e82a86556a03cdcd4b849335765dc0bb86a903a9426608810bcd7924c1918d3c2ddf49f5e340b38ffb168d7a3703be39cdec94a99eba52381af1ef0fd56eb7b9fb387b166f3e6e9db4c8055bbfbec796e014dff2f6b0efd3fa4f041254dbafedc28d70a6832fb1cb3c0443f95da22705f87d2423057dc61114a9c18503a1d0851d54471162ab50f35d89d8b522ff05cbce20fbffd9d62245a96284e6455d72678b7215d1a674076289f46b026c03e3105615b0536f2c75fc1379dc90c8253f4e12dc8f3e36112fa247b4ba8f7aa31550269cb3e14d62d1666990b6c4b100fe006456a250e65c17c43c603d26baaa68e113c57026d8a05c7a76247a66188f16190785f292edfc6f6ba463d2999342ea51801e9d8cf860043c69053664153c048a80a129b098fb45cd77e8462c0db217094220b37f0cdd4b8ff7474d5c8669e9b2109b89485091f04aba0f72862b50e7cc22a66ce935283e1491a98e9a02622ccdf7d440c2aec62690f8d028eb6721295caefa624f67aa32a10a55add6378eef7ed54af83b381982eb129b98cba6cb35c8418c690c690debc391ebd051ff0f93d295630516ab0e9f964add1111208c827489943a5defd0cbdc23da146a081903ccc139dae9e9da26c83aa355331478d204ab6d1fd15a36d9249f3d735805144918cde8dbdb55a8aabc842f751e3f1f8250aa544c2476abe244f9fc5bb1bbac88ad69f1ef14e79f03e127f8ab6ea684811dfec6652202b2f4aae212eddaffb87fd293f2f0735a1c153ac64e6c8bee44b225dc8e8d239b97f40c8dffed0111e4ef1694ed0ed3ac1d8c0a49428e323eb2117daee53059280c25cd33efa5de317b00229d737ce1e86af00496e5e96e69aeeb3670814522a593ef5ed03032ab39b9c5069e29569b166f7f70e624745be859ede31a46b099a19f69ff439bc67f4845a3bd33be66a69fbad5c3447fbc6b3ed6392112e0e47b925b1b94dffff5c291546f8fa04e1fba26ac7f2dad8d52534e0e6336fabc32b82bcd0b99bbb94e579b1b826293a59cad8599a9b84d07397e02fce2315ea8e60216d432c1a13c94311f603116d92e50b3de1fb013ade166f3e28200d18ce7d280d03240fbf878e4b45b16492f8ec59f6581166bd626b50f310a53b87a364869d6fc12e655369b4fdd6c4d5a2bd130ca5b276202da690fc08c5ee6801e72649ca06e36fa9276fb823ad15abe043731cb6e0ff80ebb09f931c05cd49a799e5cfeefd1b4757c260f8068d985c9d14eebc1087dd4534e4563b5a2f421368bbdc817829745862c53841993d1e1d0d50a25ae60f930d6705da7297c251edb61caaa49f356a79e4c131ec24569d23d108397abf8e272b3304960a82d45c7039fc64ce09ffdbb68258f730ac960748ba209a5a01244be6e7bf58a55022eb52a14ce6bbec56b096227fe6682b08411025b80ca7c7a0d492cc0807a107f2334d6037b050e43701a8bd88c0da2a22fd2348c21f5ba0ab32ea815d89da48d9284b03821c4309fc59b889227f661571c26f34e043b04defb270a363fa26d47d6c46eb5859f94e74b791a61f8dbdc124b905edaaa9039888ae705f895166bb7a479f1eb26a0583fa996e2978642a2a67353a3074ff7b2c6a5ceade410bdedd2dc95577407587461692f2e6543fa52e26a54037924c3f8d344583b833706e8c6ed8130c28f33bdb2004b43b239b2487209ce1db054cf70810f64c5fb3d803326a7092afc6d55a05b27de43c5326643f36deebf678d4ec4d0081f023db1d790ed0d8b5bc7bf62640f8922104c70cbde783c4166fd5a35bd33621f924862a542e0f180b1017de82eb427d8b773b8e20dedb6eaaad892df0fe2f45d4dcdc99c9c577f2ba48c4c52635cf2816b97d23f47e4d0cbc809c789afd940b22aba74768d8bf8c96d0a3335bd50dd49efdfac4eae1eab66b5fa4b99506224050ed77b663b233473f8f69341d631c22d34514fdc93e305afef6693ee441f633ea1b289f859c5f882e100ce0a38b9e09d50029eef8cd21fca8113ebc953fff71e8fc1ad588aa7ea7c02f422fc3b8046dfeb1c91b9c407c80d3d2b4be3dbe6676ab157f5ca1998675931132f29ef71237433269752879aa0dc70facbc4175d2fee18aadbedcce73eceea5efd9cc93d4513b896204ec67c532e658e1b34ecf22115ab5cec66e0523c14e720ce8fe7bbdca13000ce566533994a07fe8a439078100b6667a09c86dc0b9874162ffafcbb720dad6eb9fd4e9a722365b582c21132ae78b3fcf3bcac739147eb38a83c222c84dadfe9d2c5de59d7fa72da0943776fb7ceab626464fb645c5a1e354db494efcdadc350e69aef936fddfe61acc13876ec18ac36ccc1f2acca2a4e3c43789c4b49acdfc1c9e220ca363094d60ae7aa6176b8f6eef61a479fdf25c026a940f37b776d1952673198bec7ebac88f19e5c9a6e8de4906228c7a25bd482a82ced6c34c168998d17928e2b20db85fcd9e6839ab441c50587b107907337c037932c9cec6609ad42cf19873dbeb355c54c6667f325ed9c9eb2421d9dd2a57facb5d5b20bed26bb81369afc05659dc95c1673ec4ff0a9b19f08a4348495c34ddafe0a44bdaedf1246421ba0a637dc731efde08a98bdad8f108965c208abbc9f733eea89e2a9df91b8615c6f38e2f88238b267fb1f844f32ca93acc0c5e6bfd539849479521f7e445a3f2b67b16909d986e1f0aed8e096f1f2d87fe83f8dc9f4ee8e1319db4735e1204241812650817f7dde0eead13023885880726a7c06d87ca926c6f0fb98fa7793a62d9c8bd9339a6e9722f133709270cf3c12ad18ed955540995b5a23f7e3e55827f3ac6b2a2d7385b439c9a78e56eed2047ba41c0c15104b47dfcfd2f1edbac1ff988c2e9fd1ff943c9715d5a4ae2f51321523e7ea7e0a423ac6f86459b096c5c859cb8e090acf4840290d745a55185d8618a265d47b44aae64f40571c71d9d3dc6e1cc25f9ca74841495453a71e98be2c86ff2f1a1487bad0287392f18e9a58dcfcb220af9fa634900fbee5784bfc3864d40642ae182a4396a93f07850b5967a12ea796822aa4bff09edf360be2bf1d0e163a9f4f475055114478bfc1952c0a2d4235c1f67e140937999f34e6a73443d9d53104f07e7628f73a79e1d4d876a9122d290f39539b02811237fd16abc004589fb9ccb9a7c92588dba4abb7beed41ed342e219eaa9330ddd8e35f2516a04f18b97f589ec68ed9aba0e4af79b65379ba58ef5b3cf697b8a15cacc395b999e1ef4d9298b5b02238bdac81d612962ca5bcd29fdb0862f5cb8bfc9797c2dcde10cdc86fa2c9d369173d915e14dae6108da405648ddbbee48d8fd0088aa9c929376b13346f7b5bbcf539e1bd626f683cfa6f6c57dba6fc399f4bef04874115520ec8185d4b97ce28e92a0b11f29e1ce841a0c8382c72b40023caa7aed62f18071b21a6a049ef149e620dd636052050f3d0ff4437b95069fbb4700f783e4fc284c8ece92b406ba80270cbfb9cf561eb9326d90b17f609b18d4ea6a7e7d24c207579a2b7d86a30c2203c3d5d07ebceda3fdc53cc779c666cf89c51486013a8cee8c8c76c9ee94755ade4737243884859263394b1161cdbe045c904654e633ca78a3dae0496c3e93b162be90886d1cd13f2d6618b3fa810108f7f9a4e464c59983133c5fbfec200eafdac4c7c1bb2c102f3eebb9fdc489462196d4296bac0bb1f29aa6eb701e92b47f297487a1145733e240cb3645934fd7aa474c6f08269bbaafe5b4b5608bb94ec73e7994b66f2b396cd670509fc894c5ba6d7b4ae32d45b8e10305061b671e5c6d98ebce8721369a53ec50146a57b408a77b1eb4af6bfe83e43f6ceadb99f6590158987cb34de6304eecc7e86ea3a1735e9f3f9ba80186fb16b759871fbebdb702d067e8734746927e064562f15fd741512c279b4015ce08282f475a005e46702c64bc9e24e47175ed3c2292fd8af3f2171b8a39ecb9439d85978c79afe44fa40244e75dbb9b0ee9ab89372ab5cb0e47dd084a0994183c66b983e2bfb59dbb9597ab502a339c157de2b25702a6e280ff8b2cdfd1fa2f60945f5cb61ceefb9753c16fad8cfd20b02ca625c1aec0b8680ae630c8c51f6cb8a833865d48f91eff5bddf1ec92218b5a0609a66276fa3361c861902c375a4338f51bf75f91096e04f3c23551ba9e9943d8546b7af81e78add7ec33f18343be4ce39da4bfa702f0562935b699d615cf587ad41b53059cecac0022a0590109e0d37690412ad62c1e2c5a2e9012853a47d0af52234429bf04efbbb0f18af98ba37582841ace95e23dfe7c356d514cb4d184c4378e874a49a7248b3b65df5c5270cb8e7a8cdc0bb80eec2089cd0f0930a294bfe68c6ead506e39b0334f2c1f681634e5d38ffaf0bb31fa543d8579aef6b6942e63e143a0a9bc7686b5211b64e221ebdfef3988da0f4ebdd5835bf31c0c2d427d72183a2763886ff5b2d67acc4a7fb269fd29246933a105b59ab0753f7cbc2511dfa7a89af85dac98c6a7be367765a1d3d5d169ee6111d652d6ae18437e8c7a1e4b0af942eedf0a9173422268be879315a6836916227ba140f6477eda839069c8912be128555004ac8d82560e802820f2e3f70b9852d12b1825b079e4d1b3b4c0369b5dc915c80ac1d8ebd09aba2cbdf32078759cbebb57849f4a6193230e5685d47397e1966b545451e1e16f12eccab6290817800febd37cb26c30630b5704b864d596086a232c5c0628a8c29dba4575d93a4cd030ccc5176f2e6648e3ba64e180853ee8b558814b6e950a8b8f9422c8c407d57d98380449352f63e46d996272bdcd7d89c1244a2348a37b8fe1974701fc2293bd7dc301dfd0bdcfefab8b959810445e3d077ac3a99f0f28ecece817b7ecfffc5fc06edfca98bae9f235da3cf14ce3891616074169347498c7c1e705c536e2218e499e043f9a04f2d4227020037acc2841ecbe5a0f53c91bc6ca884a5c2b24cd9a3266b3d20aa9209861fe593405e6a3d2fba0cdd81882c3ca1faf794b87262718066b4fbd3f32a17aebc48daa06f90830ac95cbe0d54a6f5e083a7bd35ff4c6da7535c0a540de1b7ddacc2943e7c3288221cdcf1977b24e14d1c9973d97aadebe479609662e4cca248b0ea92c04f6df10fdb913b4bf2dba129b70b7df1a87cef309a98ffc61bba41ff67c1c94277c4a459ccbf6aed448585a226d66c885a2eacbc75b65cb8e9bff881168d42cd990e1265b8af27002ebb90740492ce58d1bfb76e701310fdd320493cd01807d22233256d47cddc9c4c30c3d2b237f090bea5c9b026d0df775887d7a436a9d8ab77898aae918c53aff985b5b4e8e243b763df8db4416b255edde36be3416191e634a15fef68e208dcef0c20e0d1db085c366785c141344fb8e7b397c88b6067bc77caddd4034d7d5e5b3ae58c5b83d43336756ab42a88c72c906c769abc4f31b85bf9d96ca0db699430f6f0062c1e581655246214e4a6ded4b4186b5553fe52509c81b9b1adb356b2341ff2b5bb69005861d67722df1947f6cd8827ba7a2a3cfd8545ed51f295718f819376b2b02a29b5955cd2833512c7fe42e5f5751edfac31c215f6f7ac6acc3b3ce459a6e7968ddf64b77c11c8c9063ef6a48bba9fee8abc5b0b054d7121d07f3d5a0517f2437d6cb9146fe4bdfd8cbf41be2b26c57f4670e3f9483be31f10fb8255061d0a8e96c164bdb84488e7d2eebce0e87f8a0c6eb6065ac29dbd886323d162f0ee22a0e59acb935e24ac292f857ee93178ae7b9323c0600613a8b6af37fff3ce62a6aaa5c44222d451d4d449fbdbf4d53abf53cf860986e7cc35c0c108eddc543085330288dd558009a7506afd43faaf657ab0575b137cefa33661e445dfefb6e2283a1880ffa0519578f0d909f0e5941610a52c4f382965fd495453a251b6b8628381b1d6f03c626c21d87d70c20e13736a8296eab283d5803013c709c91c4308e7bcdb250d8c83ba82da5a349fc2471e1b6f9233122abe4c540ffbf5ebffa2300c4f206642263a63d2a32482838f83cfc6d9767c8bc53b46d58ec806f078d079a51f14f15ca8597aab40b8841be6f460d8578a6573ca707e1a79815233ae28b41ebd60440f4d7e491ae4ad90887eb687e7d0977ac98a3a1ea278a7b5a352de9df330909ea5e76299e1488243cf3814164c2bd74c6499bc32aefa59c1003e7428abc922ff874113e2a48c022c45c15665bc838ab35fcc57e2adfcf407c5bfcf668a962cdcd0f8a5dc7c17dfd8b8b3a993644f2f5d4d6b1a0d0481776451b208c8a81f8df283dc50e65676388f16abbeba08a6f32f3149e49a47490f6308bc2bfcb839bee7647ec5e54394b553ebbe2cdfea0147113e68baaba17a1300d2a6781d74d673c17db657ae22ba04e4efb7652e0cb7bb460bf122e949897ebff7e952ed4482afc092034f3d6e6bd8e2429b2ac96f82bb27c3516bb1bf2f0f2a6e9d2833aac9da05327a4a35db603310c889bfa4546239a45873e9c73eb19c3b850589dfaf616c80067157b120332222e2f04fc8fa32b15a82487094829c0c7ed51e20a6ed74f45619e472006995eea3cf6660066235e105ec786046ae6a5e457d33305ac16caf9ed48f1175895975b4571ab63b18c6dcf4d52337193d6237ad49edb6e49279036df1a0e553733666f4aed13ae470540a4bc6877ad513fdd9cc20bd5df955b98f6c6c20e628afe084605cc0105ac7fe76d928707f743c53fdcb52ce0afd96bb7d824bd4bba02ab3c4be6e738eae697d55c5e944dc76e0144c9457b2a2dbc1f14b3732074625c41d8c38558d3537cb0d9192b306e9066433a7c81cfc30d76538ed16bda15bc8ab223012fda7ba8f4e249ae8731055925a317ae27fd2b0191509f161c7781952dabcee7d514721be07c0da5184f95b72e8066ab88517e25d2511a37de7cd421215063c878fda606c787635e5c88c16b2bd90dab0c92b0aebac15dd53be28dde7709c142fc2a10a36bb56d8e1f4955c491c9d2dd60da2b9e6331aca10a07185cf5415ca4710b82e169bb321e20d149ff795232f62bf294bdaa6d5919bd52de1b7404a59f9b1db3a183fdc24cf022b13489f7e5a8b3e29a243c2e964f2607fc22c9e9fb11b48443950bb917f093549ff78da4af8d844cded32abcce3e265f3b5f4b45b464207a7ce07dad69d38d462b63e30086514db7bbf6ce0f6d7df4abd1ad0d45f3c7b18dcbf7064848ac5aad9d3123126c6498881c4d8d2e9ae110ff60d98a79009e03c9200b28d69b5cf7f10c4832f8fb27a6bd784857e773fe3cba4fed8bd8d64f957b3e9b57f811ab22297c8421d96cd1070bf1559fb4622c9da834680a326505a9ebe426ee66762ec1c9ccb908b1f4a825c3055402f3a2b3428eb7cf75b2ecf6e1bcc7f8b98a27b85de985f5175d0c4d852a2c86a7b577324df43402e096003b48c60f2787fc75896ad64d1a1e5b7f68ec71312d01fcf22cbd59de15a4b93bb44acd2f04a3760164186053ba96352e5865b882063739a4b4b7deccc7bd7dfef402e49da36eaf9ff1c8f12c11c70e6eb3d3776843a5ec79e3f10f273ce6d062a5a1f711e93a4772fdad2b2abaab6b4f9bca02e8f45501f8fb24e1ef3a76220557f816bf86507af0d745bc96db189ba7f4863ba0cf992ffa96044cb98a7b651b8ac880a87f5f943855ccb9dbbad7a49a4765f71c36d6911450df285be00481ce80bf248418d057021f0b8d2ca6dae4f728071e183fee770b413a5721ba2221030994f62fb52dd037935c11250872b76f6c370aca7cd332f377489768faa2a2f5be32249ec130e59a6bf6e63f4d48ea260bd3237f354f5d7dc160bc8fa12cb28493d55eb2553a17cbe40106fbc6c80da07f0d8594ba88ed7918b7c6ae5ad7c9252ac022f1bcc219edd0d9389ca87b3c26dcb2d86c04fa3cb0dc455c7d0f1409335b341e7eb0d597026bf13c915cf0019e791d6112f586683373d964ef3dd051a01dbbdde31d4c48f780958c4f19bd1254ceba9930496cb6cbcbd6bc36dca2ff96efe735c16d0f2d28e9415b801084bbc523e67fab6e25413b468e6f4da5974fc9f130efd1ee7b9cab8220138e24ac6043f639c9632e9858c293a45588fc8a3f793bd8a4603e783a69fb7e617cb22f75520bbb5d17ab57e2c4f297b67384b5cbc46887b7c5201848c5d72b1f58e0d816fee53b3a3aff65c101dd3707a1f33aa6453a2f48685901ba3d50c62a205ac64a9656087ed34809b4469b6aeb8aa3d662181d5c15980a95e11c559ae8ac4df8595358c5c2aede95aca70237bab10915afa2fd4d732c4229ffd027a01a34cd9f21fd61afbcb9bb6c320c1111012b97531464347a334b7170fd4705712a05ab7b09d98d5df2e0ca4bda4e139e46e83147fcf2a5ebbdc52477fd886c3a8cb1c94420fe401742e8e472c8284493c40f97d019bc32ca1e5f1382307dfa9394a5ac31fe563ee9ab12a4f09e3042e3d35a6c72952bf75373dccd1fccdcb94a396bcb291fec48699f3600ca4ab4511264639beb0154a62a402cb81214bc240383e85ab763d5c908026438a22e33b9d93a7d29af785d0e42e7eab2e3f20917857926d93f51cbbdea84642bf48539067e80f1a89ae35534e57acb196ffbd8f3d0cb81063cac75b84e28357a747182a434a84844b5b1a5c1d6033addf75a9930abb8cb73c0ffe4e97d4d3de88c7a5c6be02ced778449515c3410376f443be678b1aed539c90510f0af09a712446309bdd279bd2b0bc16b0d5eb852af24e38f4d1fd153550f2a562a7e363fe75bfa2c5aad839869b19f22b9e402c6763a66b74e746b9365966dd9f57a9b1437374b96cc911e726bfe4adda09fa90bb25ff5b9d02d2fd29379679d332182239716ceebee1a8b7bec6a506ebf5e02817886c330f9c70fcc3a64796be93ad080b7741d2a04d86592c059b25cb8b3da0e5d287d85d9f32ed665e8d07a9c0a0089f4c7cfd55571cbff7ef2994b00d8bc4e8a4850f86dff81936d5757758be1b6a76941d9510cf9404813e4b65dab1d6b637336527086382b47a89437d3561b0465cfb32b6e60427bd70d51fc1977ce4257aff2b5fedd82c1d790a81ec6f2ec19f40e95a1238940d039cc0a0f5d822f5839a4cd92e53b14eba69a9cad6612a123faee320a4f7ce196f0e9217f3db7ae1f31b3963b56ae9b8bb0f24c41e7ab4d8e91fe32ffb40f64fb8d79f2a0b973c2715847e2132a48c1fec9d9c96763bd4ad3b09a267107147eb602e9c63a97037bc70c3d298a68d999f39ba561e149dfbff8fef965282477025f321426cafbd89d5824ac8dfa4207f7ca04e5fdc68d930b836553a2b64a269acfd18f32fbf8e8e83233764bb49a725824a929c5ea46718c225b39aa78fd638477f4f3288b98ff5d52e0e7deb4a42140b7b9052dfe0861da07696e5aac941c3e61ce09e085a8fbc5fee5df0465cf3839b53ec1cbb6c63a10dcee57111f14fc429446a2fb79e678aaae454d42e0e868d5a3a7a497ffd5a18e1d145cabde5c18e9a5019a12a0cee1f9bc2405451c618b63fda15d518709460f340a8237e660f2b64fa2465e6bc66411ae9395ae7be341de7a37b0a97b4ba855a3c66c6dd25e10c45c5deeb9b335c1df84e6a20316266ca19fb47df37a71de95773c3d7998627961ae5fdd672d34e582cef29ec7c5a74b32737c7600ce242dafc23296d32f730fe33e9b7e8dbf7ec3f7f4d5fb7ec5646d54ff9129bc2999a4eb2209c370605c68d798049c1dd2d613c09c23be6c1738fbebd1cedb29d41302375fbf80410cfe10919bcc6db85cb7151882eba896caa0d551d6c2f82272e32dfff3025eba4e5009a972a949aef35ddb029f5de74b3e7714aeb1de8f6553d31f50d3d1aefa7ef8a2be140d66d4af690629918536210981cd66b4d3d927e6d45c682f357109a46c9813d4ed7945c15bfa1d0e892266889c9066bb5ddff4fc3f2b1fce33fe7068214706d42698cbac030c60a2722b54c9d7bd3f358be3ae9763a1db1360f0a435f475cb80122be0b7ec2f46ee26ead1912a34d934c930f8f42f451ada8c6dde64aef11d3249493faf48e014c164cc44bd53f805aa1844578b05a09b0bc1013c76ce6b7ac977dcc19146beded1345d28f793cdca749a7e1a268e3b1abc6ad3ca4ea57fb00e7142d8552746aa9ce832f467a510f0d4540695935fa392890c6fe4e17e7c23b8459478656c3e17525914ebef23c97ac54d6a8ab4b328b508134a4ac684c037a997f832fbddb0c1f8d05fe8aee6cf4e71d005fe62038293feb8f8cd4b0ff75e715b522b394055bf82dbca4d6973088a79dc985650cc6213b5b797213a3b90bd4fe740e52f0afcf8872fcab2696a3c2a4b395536b0b1f9591bed316560186c883b6216a7e2a5f606e83e33765315c9f0f77ac2cc1161e6015280ab0140edf4bf33d32b0527c8ece39a6107bc9377f144c322808a7a82e2fd288e7300766294fb69fa639c750ed3037db1506c282463fc89e2a116f5a00828fd033aa0cc975f2cdc74cd2bbcfa197657f81c2f430cafa6d1f393533bae8ce3f1d9ddf58362011e170c5950e58c8faf0c6747427106cad621bd8f502c791df5eb900d8245b1c374b3dbbc42af99ef0945b9c214d5a8f4737624fc1949fca229b72aec1847c08a784a0781753a2ee5d249d44a8b902d808b8af6c27e904c4f0afe4fc5f40d3adb5c4f84c40a7f409124206739f579cf7d221bafc068ede11f91755d3ba206eb7ece1d34c805899a9cb849568cdcd36264612516afec9780e26b5af8667e34ea342b367b985fbb26400f63097eb6921883cb5f271f88945cbf71e9859fd543272373b3758dbf65559682b591afbf36f37184d345047234c7bd461c1b16cbbd81199e0892058d0a811e397642baf02b1f76c2c71f9e06de5c20dab3081504de551bf9555127d77f5df77a6524e0f8e0e076156806a21dd9715b80bd3e3df3cd952fe66934dd22640397f64edd45ba03104376857006f06b538e092942f388c1776a63a5eda17dbba30556e8055612546d6b228fdca2743e17a8b61addc5d1981d4b1c859c7fa72572f5b456e2b1eadb0d6506cb25c6e7c32cd8d78abb338dfcebf1efd5bfc77e031c24749017c22eefdc927de2acd0b88457f68f1de66bbef1c0808282583344e27230bc4f6d534c777da6a96c3cb74ec8aa99687531e88a49da7c097d9d047e7cc40e09f3c32ca8aa05440dd3729491108eb42c8a2a199ac5d7d44d75388bf75490d6a6c13ea453f76429400583d60cdde8fb8a40bbb0896cf280ffa1a04f3bfe85f8fcd5bddb8ccaca3aaa98637fbb516a5553a5e58bb5b3d3444af68b0bdebc4663fb51f005eee74a6f6aa42205a43083ea2578bf098de5f58451b9cf32bb4217dc5b97aa02cbba965df1182de78fc1f72bf73872a3e8d4b983b043e8c47644f45b469c9685eb2ae76c49695865e7474f15e682128315b728d972c84784e82a6960f4e394cb70596ee9f02c22715e5614dd249e79fb831e2d4a07c05b36bf9e69cc1d62598f1c10ae9be49e2ed64863808d5d907dcfb5faa59c4929a4a644b1ea351f7a53d694d7f16646a01b45587f9512cd227890bdaa937fecf0b7bd4e38f94dc87adc501f519258f8e95a5e09e7399a071a5d0277a11a4fce56759502d1fc701f2b451319ef3b52f915a1b418d69fa49939afde42b6bc945c41369f1fbde5e3a6a018ab58aa2cf44d741f05756aaeb0a360d37d2821d4c65975322877e2dc25f6410ee1f45cc8cc526a870fc09a30bf76cc707b3263532db2d4f145879d367a27c15c0509e7c3088338dc26e9c76771fa411a6e4cf378bb23830118e65ba1e54bff1b6a820f2c7b22013962b176be6f1eb0f84d57cadd15d181e4ea06aa061f69ec9acd935e36493f5a216725136e1cfc023b8f0cbf48ef68663215f8825b0858e1f2ea14288553a8d8748fc64dfc42e21097428179abe5624236eb047d2bb083e4eae399c150e4511ce7ab79ad76d97ab2f2aa650f734dc893f93a82f9be0a098b9bf071603576049eb57b8709f22c8f3e93cbec5b7b63bdf2955833f7cad3026988b2b1bc35d0d8393a08b757932f45610f3d31c630633d60581d11e293470657a6657b41e7530873aa03fa4db25367fca6242fe7d893d7dd0a2798163e57a9b25ac63eed84bc64a661f6e84dc73ef3c973b81df0e2327227e37f9d3577ded42db5dd0ea00cfa150a3fdd5ecfbc61f342259956bb474769b6cf71e19f28e8c71b1a558e1d215303fe7ebe2b40d5c0f3270cac93b1a728b21c03033f4b7619c1730a0c6fa828e4cbe4292709860b2fa2bc82424d2d76aaddcd668116ac6454e41f1d34300103ac1cc001a1add7ed2a3d893c77f7d669e588c6689ee2a41c7c5240edc049fac8b55d4894568043b3835e481f5aa389359d587947a4a424152d6278dd88a7521f0ea319237460a0f78c940800e85a91739cf5caad1df27b82a783eaa0a24412ceaaccfdbee99e1a1d77fc9307cb6f88571877609e0ed8d307f089298ad85174e2fc687ac58dba3f2253a35744f7279b8d2e5da2b294ca8cb06be8de5f0271d5672b7cc0550fa841d46207ebcaa660b79a9243858e8978d7c9ebbee7316cfcdc30b94c41c45040d82450b1ed98519655146178badec076cbeb7a5d2c67ba6e894a24fcfa3334ab89555d817b2a30a0b5e57424baf90d304dccd1eb25ca4d1242c64ecf1f1e034fd2f5104d5add85e38b696a42ada16c97f82860b7f0943a5b836fd032f22efc5a2419281a86c5cac4c8975672455a6fb91c0eb854f14dbdaa83dceb841922e90eea01f50a638d01566617a5b11bf8a54ac239c6129c4632a088b042c934f32bc5647b74b2183ceb0ae958f04e6e5bdd320188819469b2dd9ee5bc17b8b0f687e98f5de029d81b7231e69c93b58bdef48a9345c8035da2dded24abd3ac8490741e644355120c7e9c8a9d53190453e9f0a8ddf5108771d01e5efbfe8f4fb463ae4fdd1cde1c00c89289ca30c33798f9a9e77d449cc9bdc4c7b1580d32797b05ba6fb0d56e4314246bd0f8c96780e6985e87c075b5c20b964f11dd17e95267e3e5331d495fb1d8ccfafc408a78e86d5c46853b2038a015d1db96ce3a645d5d1c2011ce5ba8f6c5d42175ab262fe7949d0cc26d568c5f7afcb62141194e4dabbfe648a0fb4e6e640a3fd8fc992db1d355cf4e863f61a396ad8cba207615688a2a0decb90be1daa66eeb357f7bee41fbb8f695403e89b52bbcf88a69d820fe57c2cb654e64ad4661f810b53119e9d179fe5a10fe50fd2e3f6ab869f7d7162df9df468791044c221d9b847da7188aafd91e687678fe782552b9885bd090b5516640cd9ef5f247b8b59ec278657fa9da58c864206986b8ca3be5ab0e7d2a1e12c101a7b8c50597486b84ce09a2682b668e57e3210ab99494d89762b45cd3e02d1eba1da219d3de9b8905b70fb0fc2a383a7281f55e3d73656e17543f921096dadc77263da349cb2315ab5ec742d537332dedb6175e60f0a4a239cb940abcbc9bfaf824785320076bf5863319ae04605414ebe365a59427c0390ac6c86b6816e45bb530514a4cd667c0c2810fe24a0228b0bcb86cb1a9b4ac64dd24c1dfd71787929c81903f292569d23e7e547520bb0497ff31b90403b61a310282ac5e1dd36c21b8f80f8670f6d5ac06098e3c5a7d127b1aaddb24c3bdf98d0cc7d4b2c62598fbb5ab805ed76074c780d532a13b545f28f188f4037b8a94012f36fdeff2d1466907bc47a294474238fdaf59956a42f19a20ccc953c7ec7a221f997451197ec6cf26a969b4f6029f216a55d513c7bbcd8ef9afe212d8c34d114563acd5ab6244f4ba81e69210bfe1996ab201f9af2bd8efc706256db45a632fdd40288c825f3604d4919bf92741ed8420e7c5564c009b33d39844a33bcf1a541368294e25952261b33d1a5d11039bbd19881c29765e0bf0dc6d4ba704dd518952fe450dcf05656c57cfe325398034654b0d8939b4eaf7bf883bbd8a1d6ddba803805a156f226a6d965c95cdc5645486923ad3cd494c99221bb918e5801ddc4208d4ec63680f9e45d0e2f98f16ca879303b717fbab97dae612dc31198422161233fa63cbda5c1decd7c0c68de258109c644a893b0d5c52982333196aabca6926b76247cc43bac52d3f0ac9fe663776bde9105dd5228cf68e839dd2ee646f130bbc50f4536bc77f528583bf5b11f07959262154436a387cd6ff3b0707d8145eb4f2afe926e508e431c9bbaf8b90040ad19e07797ab3ff3be7838c68a4909b291d62f18b18130c2777d8a9053e7e5702607d3d30a6f4f4deef0287ec80683d4d889efdb3b48f4ad24aeab9c30a0543c79725f48a64eca545e3443f6c6830b4081d71033bef921f24bf8b6522dd4b56351c6468fa99ad7dbd4b5ca2a7e31daec2dfbf571f8ae58bcfd4624d6ec101b1107029c64247d51689bc27a2888042b99f31a6126a22df1c109851574e09023c66005232a5eb47ba35518f8b21354e4a8ed25aafa45efa695ca44c4285dd70af00f429ddc5909e504a67db1caac7642d02104ec0a1080bc34a361356ed08aac8cc75ff3aa92f0041f592ca071a14e90ec718eb7438abe0c08fa2ce25468c8e475792fb962d2e05b0edce563891c76df4cd887c0e5a8f12f5ed700fc2088d9737eb39c013793c4e729ea43a32065e307f673ad38ee8e68a35459ff5a648648795a5dbfb92fe09209bf5143f3c0a8e09c41dc2cc8208c22d2077b158136c8ab9a5a13a1e8bf72f3879445c62a66c7ace9a8c7a6aa08e566adc024ca9aa5da423f4e802455c78310932ed86a22c49b71da3b3127fcc52778eec3dab427a467a750956714053c54e81698080573aa382b44ff44d3d820fe2a4df4ce2e7334f7c59467efe876714a774b50ab2bd4966ee5744f9cf1bec8e85d930160fe7821d2741768cdc122ad22b34ccc9856af1d3fcb2921ac3fb52fd11a137f93a111c32ef56685971fc48be877adcce982176200084d8e580a3ec0ed4ad38094b5d663c29702b9cd8040b36c3fb793998e6c0ffaf84a7dd741d2ad32102c3f520ea67dd4376b1392203a73698e2777bb2b843b9666795ea9c43cae23130436aadee69a1a91ea81ab4bb52941dc7972c9f12aff801465dd23dcf27e05bf1b1b4fbb8bfc5a34e8c9a086f6b861c35583e6b16e35c45cda5cdbed713ce66907e72e615223efb289ee86a62751a1c2241dbb8ae38da4b9a9d2158f42bb27e6905a8c195a5f6c27f6ef20e1366b92abeed3f0cdcca9691622c7f59cc05f864a089f413dab08be19017798b3b60728e1cc74bbf725feb9ed3e124a214ecad17d6193ce6ec87d8c61597ddf3fad42d49257086181ccf2c34dbe79015bc000c94c731c93be374731ecf96326530cb0345926ca7fedb9eec41d1409ecbbf38e07ac53dea7e70cd441d91470e2d7db9b93aaea40b5284726c96d6e93b25f397ff7df8504eb6252932c1e6e4af23ab13f102fa060c14f7540ab80aa2ef3054555414795971c16d51df73ad8c1eca8c22242660cca7b4117723ff7da88f867ca703cf00d5c688bb29c312e1c26de61a3f4703c99f151ff27ae2877ac04fe9048e7b781e5878d20b5cda795979a6e298f40ad4d7607bf5e7f00abe573f76b398862f5bc7afabe1ccb11751c3b9a42bef602c21195f36412ac46dcab6ec5e48667d9b0e5234accf1d9a163390b1d9f1e34f6bd2137e043360766824c476375114c50d123d7a678a6f5b3fbebd8e9a4a49d4d4ab2972ce293938dc098720d0417195665e3269e57e12fffa27647e9435e5cce6424d92aa77cdc760ad74eca9bf309a5a4039e3726881ea2c79b74f71b6d52c470c1459e84bb48add9b6742528d9eb284ca9f4f30b5f73153c635d5df8007f21fab915b4d2a9b326d8d7e6c8d7e8c959feafbed81826092887abd358ab210fe24c1941845e134420a3f00339e3539b0bfc5cfc874906994f853abd29cfc88c3ce93f51190318b72d9d4811f3e95da80211821cfec0d088d3265904801878e4a4e006a40908f25f57a56f46f1453856e7ff4da959611d610f200feec38756c042a0cd86569570f8aa53d6b125241af4e0c7e77b72cc795e7f04afdff10801da039ea178596a2353e72c44a31ea2ffe1059b1da11f7a9337281dc7b769d9cee0c5fb84caac7d4a1cc7d703b3e88fcec6f1151d25f8becc56b0d761e8f544ff8feb6145e51149bb1c8bd85c2a922f2eaddff81d877824c48f9718a96a2788305f66cf8a2c83d0cb2ce1736876d07137232c8f5653ea6990a36b65a18ec8831dc8f5f8a59ed9490e68af3df2b7639a1169b7ba68aca13cd4e856c81a5a3fe17ed455bd3f524aca30dfb95b3d5252075cc2c22af46d42a03b5213f4c9e45d3b6f8f04b9dec87a307edad114f80d41a1f92d6b8af680f934db3ecf1b2d0a36b592e85c1e596c933f74d9f9ea4d32650217c61e50cd4ef46e2e2af774f0ab04d0f93f5900736e24054280acc46a1a179ecf6355b56034a3896bc74b00a5b9fe97a5b213925747b1701abd3d7f9ed982627232e0ae6937abc28a56196155ac6d1166685541a789ae1672b2ccd3cf88237730e3b54325401a86ae6ea4c57c3f3c65b0c39e2547788fffc038ce8ee5ba8c69d02804c0b90c168fe3f24ffd0fa8114536968d6d285fb567c2f5b5334ee4452c5a2b2746173877ecaf26f26b7ab7f734497363a49e94637b520d06e5848cae724a3ab8edad5a4cc3427a64f78394c86cae1b4d85cd1bc5ee3cda5336c330a1f2b133abdd25bc45ed292ee096affbf7b10fe2bdafbd6f6640ad85df9177c4a635e4831635847d07033f86e8151cc9141d55f95e2ec187f89876c3337ded8e0dbb1c8d66052b94513d0a96be276d2a8ac79a1bb5b1483493eaf487cab35d9d5a1150cea3267727fb02049e6fe2866352e46a77a8487a915852c74c69aa5e1c6fd62acf07472a44c4864687b82a246e50a7ec87e4d89c280475900b744f6769290e5a7744d16545193c25c4824b7f0733efce02b6c23fb2b9c83292b217df80ec06073ee0832fcb0e8495a9fc5353652044e850df3f6b5720067b5ddef18ad49f9ed7cabc9acdc5d142de9fa5696aef13a52974223ffb32320e98663421b93cba4c85fd41826e326fb6d3f10dd9ba927f7917cf113da8f61162acb965959d7d636684fda8203719bbf2fe96b8743a398b64aebb04f713e3b888085f91cca45d8a3d6ab2e0accab45f3a71cfce4a58e13cda1e02c221ad1364e4a307dbcbb6a449a23b9a976d066a849c657fa819728f82810a984431deca654aef0d039201680fa40ffdd47a5ee2cfb241a6381ea9d912f475507e21731ef6cff766807c3f1e652931e2c4b5a360044fc3f4e922c4bd16f9dddc595b89ce1d1b7b1a5149249a56d92a45651d2b403c73801db289187d921c9d439aa770793407c56f1c17e2e3927413dfd465efaddf1d2290bbe14b5d47057d25049d6cc4c71638f20084728b0058d957bf8ccd9385297c1cbf9d04f69166ffc309f867452907df57be2e78e09f724a8467f95d677a08490bd02ce0742af201041fbdcf0264aa7f0082df9cd4a87263733359c9f5a8505a5a19c88a2ba37f3230f7bcddf082b192edb91a844281bd2e6456a6ff5565fea25ff49aa0b2b47e1200256654baf2d063f600baea714d6b12a94d8750400d445a63122b4cf28784749a0380698cd22750a04d4a51c88c4502dc5fafc099abacb82f23cf3dd27838881ddc3b066ef393df4a2efc35215e6ea031c563e5b3b3b5298a5f0135f1adaf697bd439de46a170410c3974da3dbc9a7583afa234081b801421ddfa2c0ea3b3977c23a340b1c286f4648387d8f1adcd9493fd430f4f87441eca4f9fe9d9b4a5dc7a1f4398f5e40406ec5a0f9d0fb904a3701f06a1f27a725d533f0a407944cd458fbdc48a5c572662dc44865602b9d661944c1190a56346043f478a5b38c6aa14fa0dd3ebb235e17c9ce3522e7cbbb78cdfc5200e400445ffd16cf493f4d7e9e7ec63406d0b3f7eb517eea40210b5545fb65d675b76f517a56ae5bb5261de118e24a019649ecb4a014e21d867abad7e5ee55d3791481f43738ad2de35301aac46091522036bf317cb1b772dc243f50ec69f54c4bc6652eba43453eaf9e6b12d85b7536a291660e95daddd3506862aee6d3e826c2958586d42724d59333ffd294c3897c5ed81afb0c0d71e9a6159223b308d8c5559affd418823094e498605f2269e10abce05895473dcd8948fcfdeb771e3f37193132ae6885c15a4ee2a31ada0f018a0baf22913ddc614c68ddaaec139931818eaba28251d274fb434e88a5330239dc0f5c3d208b1f23a3a6fd5e5ebcc0ddf8cd78ac5c2accce72cc4347a2ee442dfa8cba78528632870d054e829a0c0d54d2928c00ae37b2f79e8958f0346abb2b3437bcbad8dfb496ec6d9bf7cf4dee14777213a948084cef93ff9d2eba486451480e8d8c981c50c738b6c1d5dddf0a3582bd3e5858a7343b735fc98b024bb7b86d3615aee9ed9473b55e5f4f750f920f0e24a07562286081f71f34800b5d0a4d2c808c4f585df7c866eb823bcf36bf81c7ed18dd96dafcbac992660e1d24f0f09e228366712975755cdec61d31823d8409e2e7d1d38eb2b79f5a05b3b97cbc347473180cb163ec21b30d11e4b71b77962b2f894dc0bfdcf92d13fbe67f830185b137e67ec234dba3c6c0cf94a1d97abb28335093ed703cb7869b23a44a0a7bd3850da6ba11de14e693e70e435c7dd6785b46583387c893b1fde03aaa75ea295e8f8d29211f27fd69640840e9b1af50f16b60207b6a7691f6b53eec9173d9980f3db6e26d37d92de18de3540457a38b4c2efa375db6b98189abd83e284bf61949cf0c60bc41a6ae4fb671ec52901625b294bdb9cd9cbe79403340848704dc72c88eede07b609f00b0ba067da342d059766bfc058cbbce2797e879d139442eee90025a2c66711c99965820ac6b3aa1163b7f6dd6eb41b143c49b2dc4f95d522584157377e73ce2cd4313def0a1f8ab21e4d2e7210c8659e79c3436f450bb09b082048f867c6fb10295315c9c753091eff620a063eda7475","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"ad81cc14438ac66473b40334d8ecf90b"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
